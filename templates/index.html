<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1"
    />

    <title>DOC-GUARD | AI PDF Duplicate Detector</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />

    <style>
      body {
        min-height: 100vh;
        background: radial-gradient(circle at top, #0d6efd22, #0b1020 65%);
        color: #f8f9fa;
      }

      .brand-badge {
        width: 56px;
        height: 56px;
        border-radius: 50%;
        background: rgba(13, 110, 253, 0.15);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        letter-spacing: 1px;
        font-size: 0.9rem;
        color: #0d6efd;
      }

      .main-card {
        background: rgba(15, 23, 42, 0.9);
        border-radius: 1.25rem;
        border: 1px solid rgba(148, 163, 184, 0.25);
        box-shadow: 0 18px 45px rgba(15, 23, 42, 0.9);
      }

      .main-title {
        font-size: 1.95rem;
        font-weight: 700;
        letter-spacing: 0.03em;
      }

      .subtitle {
        font-size: 0.98rem;
        color: #cbd5f5;
      }

      .upload-box {
        border: 1px dashed rgba(148, 163, 184, 0.6);
        border-radius: 0.9rem;
        padding: 1.5rem;
        background: rgba(15, 23, 42, 0.8);
      }

      .footer-text {
        font-size: 0.8rem;
        color: #9ca3af;
      }

      input[type="file"]::file-selector-button {
        border-radius: 999px;
      }

      /* --------- Loading overlay ---------- */
      .loading-overlay {
        position: fixed;
        inset: 0;
        background: rgba(5, 10, 25, 0.85);
        display: none;              /* hidden by default */
        align-items: center;
        justify-content: center;
        z-index: 9999;
      }

      .loading-card {
        background: #0b1020;
        border-radius: 1rem;
        padding: 2rem 2.5rem;
        box-shadow: 0 18px 45px rgba(0, 0, 0, 0.6);
        text-align: center;
        max-width: 360px;
      }
    </style>
  </head>

  <body>
    <!-- Loading overlay -->
    <div id="loadingOverlay" class="loading-overlay">
      <div class="loading-card text-light">
        <div class="mb-3">
          <div class="spinner-border" role="status" aria-hidden="true"></div>
        </div>
        <h5 class="mb-2">Analyzing your documentsâ€¦</h5>
        <p id="progressText" class="mb-0 small text-muted">
          Uploading & processing (0%)
        </p>
      </div>
    </div>

    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-xl-6 col-lg-7 col-md-9">
          <div class="main-card p-4 p-md-5 mt-4">
            <!-- Brand -->
            <div class="d-flex align-items-center mb-3">
              <div class="brand-badge me-3">
                DG
              </div>
              <div>
                <div class="text-uppercase small text-secondary fw-semibold">
                  DOC-GUARD
                </div>
                <div class="fw-semibold text-light">
                  AI Powered Document Checker
                </div>
              </div>
            </div>

            <!-- Title & subtitle -->
            <h1 class="main-title mb-2">
              Detect Duplicate & Similar PDFs
            </h1>
            <p class="subtitle mb-4">
              Upload one or more PDF files and let DOC-GUARD compare them
              against your existing document database using CLIP + FAISS.
            </p>

            <!-- Upload Form -->
            <form
              id="uploadForm"
              method="post"
              action="/post"
              enctype="multipart/form-data"
            >
              <div class="upload-box mb-3">
                <label for="inputGroupFile02" class="form-label mb-2">
                  Select PDF files
                </label>
                <p class="small text-muted mb-3">
                  You can upload multiple PDFs at once. Each file will be checked
                  and marked as
                  <span class="text-success fw-semibold">Unique</span> or
                  <span class="text-warning fw-semibold">Duplicate</span>.
                </p>

                <div class="input-group">
                  <input
                    type="file"
                    multiple
                    name="pdf"
                    class="form-control"
                    id="inputGroupFile02"
                    accept=".pdf"
                    required
                  />
                </div>
              </div>

              <button
                id="submitBtn"
                class="btn btn-primary w-100 py-2 fw-semibold"
                type="submit"
              >
                Analyze Documents
              </button>
            </form>

            <!-- Note -->
            <p class="footer-text mt-3 mb-0">
              Note: Uploaded files are processed on the server and stored
              in categorized folders (<code>unique</code> / <code>duplicate</code>).
            </p>

            <!-- Results -->
            {% if results and results|length > 0 %}
              <hr class="border-secondary my-4" />
              <h5 class="mb-3">Analysis Results</h5>
              <ul class="list-group">
                {% for r in results %}
                  <li class="list-group-item">
                    {{ r }}
                  </li>
                {% endfor %}
              </ul>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"
    ></script>

    <!-- Simple loading overlay script -->
    <script>
      const form = document.getElementById("uploadForm");
      const overlay = document.getElementById("loadingOverlay");
      const progressText = document.getElementById("progressText");
      const submitBtn = document.getElementById("submitBtn");

      if (form) {
        form.addEventListener("submit", function () {
          // show overlay
          overlay.style.display = "flex";
          // disable button
          submitBtn.disabled = true;

          // fake progress % just for UX
          let p = 0;
          const interval = setInterval(() => {
            p = Math.min(p + 5, 99); // stop at 99%, server response will reload page
            progressText.textContent = `Uploading & processing (${p}%)`;
            if (p >= 99) {
              clearInterval(interval);
            }
          }, 300);
        });
      }
    </script>
  </body>
</html>
